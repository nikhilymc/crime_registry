# DESIGN DECISIONS

  **Addressing Scheme**

The addressing scheme is selected to be unique in such a way that the first 6 hexadecimal characters of the hashed value of `FAMILY NAME `,second 32 hex characters are the hashed values of unique `Aadhar Number` and the rest from the hash of the `Case ID` . Since the aadhar number is unique for each person,we can easily trace the case detials of a person (if any registered) just by geting his/her aahdar number. Thus search becomes easier.

  **Application's Work**
  The app can be accessed by anyone but only the police sations have the right to register a case and update the case.Among them, some police staions are given some additional privilage.Only these stations have the right to delete the case that is registered by any other stations. Stations register and update the cases by providing their private key.All stations can also view the cases registered in the network by typing the aadhar number of whom they wanted to know. Public people have access to view part only.They can just check for the cases(if any registered) by getting the aadhar number of a person of whom they wanted to search.

**Stations workflow**

**Registration**
As the user gets into the Crime Registery System he can see a home page where he can choose what to do. If he chooses Registration he is routed to a registration page with textareas for entering his private key ,aadhaar number,name, case id, case type, evidence, policestation and current status. 

When we click the submit button then a function addCase() is triggered in the main.js. The data is taken in main.js using document.getElementById('id').value. The data is then passed to the index.js as in json format.

The data got from the ['/add'] is then stored to variables from the body and the userclient class is called using an instance or the object created for that class and the data is passed to adddetails function of the userclient.

The data is received in the adddetails function, there an address is generated by first 6 characters of hash of family name,then followed by hash of aadhaar number (32 characters) and hash of case id (32 charecters). Then a function createTransaction is called by passing arguments signer,payload,address,publicKey,FAMILY_NAME. In createTransaction function, using transcation headerBytes transaction is created then is packed together to form bathches then the batches are grouped to bachlist and is converted to batchlistbytes and send to an async function sendtransaction and from there the data is passed to the Transaction processor.

The data is passed to the apply function the data is decoded and converted to array and is the passed to the adddetails function in the TP. In adddetails the data is passed with context,address,payload to the writeTostore function. In the writeToStore function the payload data is written to the state.

**View**
If he chooses View case details he is routed to a view case details page with textareas for entering aadhaar number.When he click the view button then a function viewupdate is triggered in the main.js. The data is taken in main.js using document.getElementById('id').value. The data is then passed to the index.js as in json format.

The data got from the ['/viewdetails'] is then stored to variables from the body and the userclient class is called using an instance or the object created for that class and the data is passed to getDetails function of the userclient.

The data is received in the getDetails function, there an address list is created by first 6 characters of hash of family name, then followed by hash of aadhaar number (32 characters). Then fetch state data from end point http://rest-api:8008/state?address=address' and return to /viewdetails in index.js using an await function.

Here using foreach function data in each state is obtained and converted to base 64 and then to arry using .split(',') function and push to persondetails. Then it is passed to a main.js and then rendered it to an hbs table.

**Updation**
If he chooses Update case status he is routed to a update case status page with textareas for entering aadhaar number and case id.As mentioned in view details above, the data will be avilable in table.

After entering status data and private key click the update button, then a function statuschange is triggered in the main.js. The data is taken in main.js using document.getElementById('id').value. The data is then passed to the index.js as in json format.

The data got from the ['/updatedetails'] is then stored to variables from the body and the userclient class is called using an instance or the object created for that class and the data is passed to adddetails function of the userclient.

The data received in the adddetails function, a new transaction is sent to transaction processor with changed values for the respective fields  to re-write the state address of a case once registered.

The data is passed to the apply function where the data is decoded and converted to array and is the passed to the updatedetails function in the TP. In updatedetails the data is passed with context,address,payload to the writeTostore function. In the writeToStore function the payload data is written to the state.

**MainStations workflow**

Registration, view and updation are same as mentioned above

**Delete Case**
If he chooses Update case status he is routed to a update case status page with textareas for entering aadhaar number and case id.As mentioned in view details above, the data will be avilable in table.

After entering private key click the update button, then a function deleteCase is triggered in the main.js. The data is taken in main.js using document.getElementById('id').value. The data is then passed to the index.js as in json format.

The data got from the ['/deletecase'] is then stored to variables from the body and the userclient class is called using an instance or the object created for that class and the data is passed to deletedetails function of the userclient.The data received in the deletedetails function, a new transaction is sent to transaction processor to delete the data in state address of a case once registered.

The data is passed to the apply function where the data is decoded and converted to array and is the passed to the deletedetails function in the TP.  In the deletedetails function the data in the state is deleted using context.deleteState([address]).


**Public's workflow**

The app is open for all the public people where they have only access to view part.They can just check for the cases(if any registered) by getting the aadhar number of a person of whom they wanted to search.
This view process is already explained in the stations workflow. The same steps are invoked when a search is done.
